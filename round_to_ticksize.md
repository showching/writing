# Round to TickSize (C++)

###### tags: `c++` `面试题` `浮点数`

期货的价格，有一个最小变动单位，也叫`TickSize`。假设`TickSize=0.2`，请写一个程序把任意价格round到最小变动单位。
例如：
- 9.03 round 之后是9.0；
- 9.12 round之后是9.2；
- 9.1 round之后也是9.2。

---

### 参考答案（1）

先除TickSize再取整，最后再乘以TickSize。
```cpp
double RoundToTickSize(double value)
{
    return static_cast<int>(value / 0.2 + 0.5) * 0.2;
}
```

### 参考答案（2）

先乘以TickSize的倒数再取整，最后再除以TickSize的倒数。
```cpp
double RoundToTickSize(double value)
{
    return static_cast<int>(value * 5.0 + 0.5) / 5.0;
}
```

## 附加题
**问：以上两个参考答案哪个更好？**
答：（2）更好。事实上（1）算出来的值可能是错的。

**问：为什么（1）算出来可能是错的？取整的时候用乘法和用除法为什么会有差距？**
答：因为除法运算比乘法运算更容易产生误差。除法运算中的除数可能无法被精确地表示为二进制小数，从而导致计算机在进行除法运算时产生舍入误差。而乘法运算中，两个数的乘积可以被精确地表示为二进制小数，因此不容易产生舍入误差。

**问：浮点数乘法和浮点数除法相比速度差得大吗？**
答：在 C++ 中，浮点数的乘法和除法速度差异不大，因为现代计算机都有专门的硬件支持浮点数运算，这些硬件可以同时执行多个浮点数运算，从而提高了浮点数运算的速度。因此，在实际应用中，你不需要过分担心浮点数的乘法和除法速度问题。
